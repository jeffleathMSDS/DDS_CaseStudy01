---
title: "DDS Case Study 1"
author: "Ganesh  and Jeff"
date: "October 8, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

## Load packages
library(plyr)
library(tidyr)
library(dplyr)
library(base)
library(ggplot2)

## read in brewery csv file
brewery = read.csv("Source/Breweries.csv", header = TRUE)
str(brewery)
## change names in file
names(brewery) <-c("Brewery_id","Brewery_Name", "City", "State")
str(brewery)


## read in beers csv file
beers = read.csv("Source/Beers.csv", header = TRUE)
str(beers)




```



## ** Background **

Backgound:

GJ Brewhouse, is a startup microbrewery that is researching the existing 'craft brew' market in the US.  They have raised funds that will allow them to grow and they want to survey the landscape to identify space to fill a niche.

GJ Brewhouse has commissioned market research from leading Data Scientist, Ganesh and Jeff, who tutored under world renown Data Scientist, Jacquelyn Cheun.

The principal 'customer' at GJ Brewhouse, is JC, who is Vice-President of Analytics.  The presentation will have some technical components, at the request of JC.

## Introduction

Good Evening,

We, Jeff and Ganesh, are pleased to report back to you on your request for information and data available relative to the Craft Brew market in the continental US.

We will be addressing the six specific questions outlined in your RFI, but will be glad to deep dive into any area as you would like.

We understand your technical prowress, so we will also provide a flavor of the underlying process.


## Questions


1.	How many breweries are present in each state?

Following are the tables explaining about Statewise brewery counts
```{r brewery_data, echo=TRUE} 
## Answer Question 1:  Brewery count by state
table(brewery$State)
```


2.	We have merged the current beer product and active brewery lists to provide a meshed data product.  Will are displaying a snapshot of the data as an example. 

a. First 6 records are below
```{r merged_files, echo=TRUE}
## Merge files
newtable <- merge(beers, brewery, by="Brewery_id")
## NOT USED str(newtable)

## first 6 records of merged files
head(newtable,6)

```

b. Last 6 records are as follows

```{r merged_last_6, echo=TRUE}

## last 6 records
tail(newtable, 6)
```


3.	You had asked us to quantify the breadth of the data.  Below, we are displying the number of missing data elements (i.e. NA's) in for each data field.

```{r missing_na, echo=TRUE}
## this code counts the N/A for each column
na_count <-sapply(newtable, function(y) sum(length(which(is.na(y)))))
na_count
```
4.	Compute the median alcohol content and international bitterness unit for each state. 



```{r statewise_abv_ibu, echo=TRUE}
## calc median ABV by state
medianABV <-aggregate(ABV ~ State, newtable, median)


## need bar plot


## calc median IBU by state
medianIBU <-aggregate(IBU ~ State, newtable, median)


## merging the two tables
q4 <- merge(medianABV, medianIBU, by="State")
names(q4) <-c("State","Median ABV","Median IBU")
q4

## need bar plot
```

5.	Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

a. State with maximun  alcoholic beer :
```{r max_abv, echo=TRUE}
## State which is having maximum alcoholic content
## Find Max alcoholic content beer (column ABV) from newtable
## Identify the index of the max 
## Display the value of state column represents the max alcoholic content beer
maxABV <- max(newtable$ABV, na.rm = TRUE)
maxABVIndex <- which(newtable$ABV == maxABV )
trimws(as.character(newtable$State[maxABVIndex]))
## Highest alcoholic content state
## trimws(as.character(medianABV$State[which(medianABV$ABV == max(medianABV$ABV))]))
## 

```

b. State with most bitter beer : 
```{r max_ibu, echo=TRUE}
## State which is having most bitter content
## Find most bitter content beer (column IBU) from newtable
## Identify the index of the max 
## Display the value of state column represents the most bitter content beer
maxIBU <- max(newtable$IBU, na.rm = TRUE)
maxIBUIndex <- which(newtable$IBU == maxIBU )
as.character(newtable$State[maxIBUIndex])
## Most aggregated bitter content state 
## trimws(as.character(medianIBU$State[which(medianIBU$IBU == max(medianIBU$IBU))]))
```

6.	Summary statistics for the ABV variable.

```{r abv_summary, echo=TRUE}
## Summary of the ABV 
summary(newtable$ABV)
```

7.	Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.

Follwoing Scatter plot shows relation between bitterness and alcoholic content

```{r ibu_vs_abv_scatter, echo=TRUE}
## Draw scatter plot using ggplot2 to determine the relation between ABV and IBU
ggplot(na.omit(newtable), aes(x=ABV, y=IBU))+geom_point()+ylab("Bitterness (IBU)")+xlab("Alcoholic Content (ABV)")+ggtitle("Bitterness affect of Alcoholic content in Beer")

```

Above plot indicates that bitterness value increases with alocoholic content in beer, though there are few exceptions 


## Conclussion

Placeholder for conclussion to the project.

